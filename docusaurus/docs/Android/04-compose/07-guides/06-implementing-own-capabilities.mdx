# Implementing Own Capabilities

Each `Channel` has a list of capabilities that can be performed in it, such as muting a user, deleting messages and many
others. Not all channels should have the same capabilities neither should all users, which is where own capabilities
come into play.

Inside of `Channel` you will find a property with a signature `ownCapabilities: Set<String>`. Which channel capabilities
this set contains depends on the current user’s role (e.g. admin, guest, etc.), the channel type (e.g. messaging,
livestream, etc.) and channel level settings. You can read more about channel
capabilities [here](https://getstream.io/chat/docs/android/channel_capabilities/?language=kotlin) and more about channel
level settings [here](https://getstream.io/chat/docs/android/channel-level_settings/).

## Integrating channel capabilities into the UI

If you are using our own UI in combination with our `ViewModel`s, then own capabilities work out of the box without any
additional effort from your side, otherwise you will have to pass the correct set of capabilities to individual components.

Different components have different ways of passing own capabilities to them, so we’ll go through them individually.

:::note
As a safety precaution, by default an empty set is passed wherever `ownCapabilities: Set<String>` is required. This gives the user no capabilities. Passing a set containing all capabilities will give the user potentially dangerous capabilities such as the ability to delete any message.
:::

### MessageComposer

```kotlin
@Composable
public fun MessageComposer(
        messageComposerState: MessageComposerState,
        onSendMessage: (String, List<Attachment>) -> Unit,
        modifier: Modifier = Modifier,
        onAttachmentsClick: () -> Unit = {},
        onCommandsClick: () -> Unit = {},
        onValueChange: (String) -> Unit = {},
        onAttachmentRemoved: (Attachment) -> Unit = {},
        onCancelAction: () -> Unit = {},
        onMentionSelected: (User) -> Unit = {},
        onCommandSelected: (Command) -> Unit = {},
        onAlsoSendToChannelSelected: (Boolean) -> Unit = {},
        headerContent: @Composable ColumnScope.(MessageComposerState) -> Unit = {
            // Default content
        },
        footerContent: @Composable ColumnScope.(MessageComposerState) -> Unit = {
            // Default content
        },
        mentionPopupContent: @Composable (List<User>) -> Unit = {
            // Default content
        },
        commandPopupContent: @Composable (List<Command>) -> Unit = {
            // Default content
        },
        integrations: @Composable RowScope.(MessageComposerState) -> Unit = {
            // Default content, uses own capabilities to regulate integrations
        },
        label: @Composable (MessageComposerState) -> Unit = {
            // Default content
        },
        input: @Composable RowScope.(MessageComposerState) -> Unit = {
            // Default content
        },
        trailingContent: @Composable (MessageComposerState) -> Unit = {
            // Default content, uses own capabilities to regulate the send button
        },
)
```

`MessageComposer` contains a parameter `messageComposerState: MessageComposerState`. This class holds all the necessary
state to make `MessageComposer` work, including a set of own capabilities. These are used by the default components
hosted in the `MessageComposer`.

The file containing `MessageComposer` can be
found [here](https://github.com/GetStream/stream-chat-android/blob/0f1f54e912baf7a7284d9a4d1435fb6743aa9c78/stream-chat-android-compose/src/main/java/io/getstream/chat/android/compose/ui/messages/composer/MessageComposer.kt#L214)

```kotlin
public data class MessageComposerState(
        val inputValue: String = "",
        val attachments: List<Attachment> = emptyList(),
        val action: MessageAction? = null,
        val validationErrors: List<ValidationError> = emptyList(),
        val mentionSuggestions: List<User> = emptyList(),
        val commandSuggestions: List<Command> = emptyList(),
        val coolDownTime: Int = 0,
        val messageMode: MessageMode = MessageMode.Normal,
        val alsoSendToChannel: Boolean = false,
        val ownCapabilities: Set<String> = setOf()
)
```

`MessageComposer` regulates the following capabilities:

- send-message
- send-links
- upload-file

### SelectedMessageMenu

```kotlin
@Composable
public fun SelectedMessageMenu(
        message: Message,
        messageOptions: List<MessageOptionItemState>,
        ownCapabilities: Set<String>,
        onMessageAction: (MessageAction) -> Unit,
        onShowMoreReactionsSelected: () -> Unit,
        modifier: Modifier = Modifier,
        shape: Shape = ChatTheme.shapes.bottomSheet,
        overlayColor: Color = ChatTheme.colors.overlay,
        reactionTypes: Map<String, ReactionIcon> = ChatTheme.reactionIconFactory.createReactionIcons(),
        @DrawableRes showMoreReactionsIcon: Int = R.drawable.stream_compose_ic_more,
        onDismiss: () -> Unit = {},
        headerContent: @Composable ColumnScope.() -> Unit = {
            // Default content, uses own capabilities to regulate sending reactions
        },
        centerContent: @Composable ColumnScope.() -> Unit = {
            // Default content
        },
)
```

The file containing `SelectedMessageMenu` can be
found [here](https://github.com/GetStream/stream-chat-android/blob/0f1f54e912baf7a7284d9a4d1435fb6743aa9c78/stream-chat-android-compose/src/main/java/io/getstream/chat/android/compose/ui/components/selectedmessage/SelectedMessageMenu.kt#L60)

`SelectedMessageMenu` regulates the following capability:

- send-reaction

Additionally, you can create a list of `messageOptions` using the following function provided by the SDK:

```kotlin
@Composable
public fun defaultMessageOptionsState(
        selectedMessage: Message,
        currentUser: User?,
        isInThread: Boolean,
        ownCapabilities: Set<String>,
): List<MessageOptionItemState>
```

This function uses `ownCapabilities` to produce the correct list of `MessageOptionItemState`.

`defaultMessageOptionsState` regulates the following capabilities:

- send-reply
- pin-message
- delete-any-message
- delete-own-message
- update-any-message
- update-own-message

### SelectedReactionsMenu

```kotlin
@Composable
public fun SelectedReactionsMenu(
        message: Message,
        currentUser: User?,
        ownCapabilities: Set<String>,
        onMessageAction: (MessageAction) -> Unit,
        onShowMoreReactionsSelected: () -> Unit,
        modifier: Modifier = Modifier,
        shape: Shape = ChatTheme.shapes.bottomSheet,
        overlayColor: Color = ChatTheme.colors.overlay,
        reactionTypes: Map<String, ReactionIcon> = ChatTheme.reactionIconFactory.createReactionIcons(),
        @DrawableRes showMoreReactionsIcon: Int = R.drawable.stream_compose_ic_more,
        onDismiss: () -> Unit = {},
        headerContent: @Composable ColumnScope.() -> Unit = {
            // Default content, uses own capabilities to regulate sending reactions
        },
        centerContent: @Composable ColumnScope.() -> Unit = {
            // Default content
        },
)
```

The file containing `SelectedReactionsMenu` can be
found [here](https://github.com/GetStream/stream-chat-android/blob/0f1f54e912baf7a7284d9a4d1435fb6743aa9c78/stream-chat-android-compose/src/main/java/io/getstream/chat/android/compose/ui/components/selectedmessage/SelectedReactionsMenu.kt#L62)

`SelectedReactionsMenu` menu regulates the following capability:

- send-reaction

### SelectedChannelMenu

```kotlin
@Composable
public fun SelectedChannelMenu(
        selectedChannel: Channel,
        isMuted: Boolean,
        currentUser: User?,
        onChannelOptionClick: (ChannelAction) -> Unit,
        onDismiss: () -> Unit,
        modifier: Modifier = Modifier,
        shape: Shape = ChatTheme.shapes.bottomSheet,
        overlayColor: Color = ChatTheme.colors.overlay,
        headerContent: @Composable ColumnScope.() -> Unit = {
            // Default content
        },
        centerContent: @Composable ColumnScope.() -> Unit = {
            // Default content, uses own capabilities to regulate
            // deleting and leaving channels
        },
)
```

`SelectedChannelMenu` contains a `Channel` value. It uses the `ownCapabilities` property contained by that `Channel`
value to leverage own capabilities inside the default center content.

The file containing `SelectedChannelMenu` can be
found [here](https://github.com/GetStream/stream-chat-android/blob/0f1f54e912baf7a7284d9a4d1435fb6743aa9c78/stream-chat-android-compose/src/main/java/io/getstream/chat/android/compose/ui/channels/info/SelectedChannelMenu.kt#L66)

`SelectedChannelMenu` regulates the following capabilities:

- leave-channel
- delete-channel

## Other own capabilities

There are channel capabilities which are not implemented in the SDK because we do not offer the corresponding components
or the functionality.
You can implement these yourself after creating the correct components.

These are as follows:

- freeze-channel
- set-channel-cooldown
- search-message
- update-channel
- update-channel-members
- ban-channel-members

Additionally, the capability 'send-typing-events' is implemented in our `MessageComposerController` used by
our `MessageComposerViewModel`.
Please keep this in mind should you wish to not use our `ViewModel`s.